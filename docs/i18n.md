# Internationalization (i18n)

## Overview

This application uses a sophisticated internationalization system built with [next-intl](https://next-intl-docs.vercel.app/) that supports 8 languages with automatic translation capabilities powered by OpenAI.

## Supported Languages

| Language | Code | Status     | Notes                           |
| -------- | ---- | ---------- | ------------------------------- |
| English  | `en` | ✅ Default | Primary source for translations |
| German   | `de` | ✅ Auto    | Auto-translated from English    |
| Spanish  | `es` | ✅ Auto    | Auto-translated from English    |
| French   | `fr` | ✅ Auto    | Auto-translated from English    |
| Dutch    | `nl` | ✅ Auto    | Auto-translated from English    |
| Italian  | `it` | ✅ Auto    | Auto-translated from English    |
| Russian  | `ru` | ✅ Auto    | Auto-translated from English    |
| Turkish  | `tr` | ✅ Auto    | Auto-translated from English    |

## Architecture

The i18n system consists of three main parts:

1. **Source Files** (`messages-src/en/`): English language files organized by feature
2. **Compiled Files** (`messages/`): Merged translation files for each language
3. **Translation Scripts**: Automated tools for merging and translating content

## Translation Workflow

### 1. Source Language Management

English (`en`) serves as the source language. All translations originate from English files organized in `messages-src/en/` by feature or page.

To add new translations:

1. Create or edit files in `messages-src/en/`
2. Run `npm run translations:merge` to compile into `messages/en.json`

### 2. Automatic Translation

The project includes an intelligent translation system that:

- Detects changes in English source files
- Translates only changed or new content
- Preserves the structure of nested translations
- Handles placeholders and formatting

To run auto-translation:

```bash
# Ensure OPENAI_API_KEY is set in .env
npm run translations:translate
```

The translation system features:

- **Incremental Updates**: Only processes changed content to save API calls
- **Batch Processing**: Groups translations for efficiency
- **Error Recovery**: Automatically retries failed translations
- **Progress Tracking**: Shows detailed progress during translation
- **Change Detection**: Compares with cached versions to identify updates

## Locale Detection

The system determines user locale through a priority chain:

1. **Cookie** (`NEXT_LOCALE`): User's saved preference
2. **Browser Language**: From `Accept-Language` header
3. **Default**: Falls back to English

This ensures users see content in their preferred language while allowing manual override through the locale switcher.

## Usage in Components

### Basic Usage

```typescript
import { useTranslations } from "next-intl";

export function HomePage() {
  const t = useTranslations("pages.home");

  return (
    <div>
      <h1>{t("title")}</h1>
      <p>{t("description")}</p>
    </div>
  );
}
```

### With Parameters

```typescript
// In messages: "welcome": "Willkommen, {name}!"
<p>{t("welcome", { name: "User" })}</p>
```

### Server Components

```typescript
import { getTranslations } from "next-intl/server";

export async function ServerComponent() {
  const t = await getTranslations("pages.home");
  return <h1>{t("title")}</h1>;
}
```

## Best Practices

### Translation Key Naming

Use descriptive, hierarchical keys organized by feature:

- `pages.home.title` - Page-specific content
- `common.buttons.save` - Shared UI elements
- `features.auth.login` - Feature-specific text

### Content Guidelines

- Keep translations concise and context-aware
- Use placeholders for dynamic content: `{userName}`, `{count}`
- Avoid hardcoding text in components
- Group related translations together

### Performance Considerations

- Translations are loaded at build time for optimal performance
- Only required translations are sent to the client
- The system automatically handles code splitting for translations

## Scripts

### `messages:merge`

Combines all English source files from `messages-src/en/` into a single `messages/en.json` file. Run this after adding or modifying source translations.

### `translations:translate`

Detects changes in the English source and automatically translates to all supported languages. Requires `OPENAI_API_KEY` in environment variables.

## Troubleshooting

### Common Issues

1. **Missing Translations**

   - Ensure you've run `npm run translations:merge` after adding new keys
   - Check that the key path matches exactly in your component

2. **Translation Not Updating**

   - Clear the `.translation-cache` directory
   - Run `npm run translations:translate` again
   - Verify the English source file has the updated content

3. **API Key Issues**
   - Confirm `OPENAI_API_KEY` is set in `.env`
   - Check that the key has sufficient credits
   - Verify the key has access to the required models

## Configuration

The main configuration file `next-intl.config.ts` controls:

- Available locales
- Default locale
- Locale detection behavior

Currently, only English is enabled as the default locale in the configuration, though the system supports 8 languages total. Additional languages can be activated by updating this configuration.
